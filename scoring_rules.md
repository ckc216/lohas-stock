# 財經指標評分標準 (Scoring Rules)

## 1. 月營收年增率 (Monthly Revenue YoY Growth)

### 變數定義
- **Data Source**: 最近 6 個月的月營收年增率數據 (YoY %)。
- **M0**: 最新一個月的年增率。
- **M1**: 上一個月的年增率。
- **M2**: 上上個月的年增率。
- **Avg**: 過去六個月年增率的平均值。
- **CNY Adjustment (農曆年調整)**:
  - 若最新數據為 **2月**：
    - `M0` = (當年1月營收 + 當年2月營收 - 去年1月營收 - 去年2月營收) / (去年1月營收 + 去年2月營收) * 100%
    - `M1` = 去年 12 月的年增率 (跳過單獨的 1 月)
    - 數據序列調整為 5 筆：[M0(1+2月), M1(12月), M2(11月), M3(10月), M4(9月)]
    - 計算 `Avg` 時，即計算這 5 筆數據的平均 (代表過去6個月區間)。
  - 若最新數據 **非 2月**：
    - 數據序列為 6 筆：[M0, M1, M2, M3, M4, M5]
    - 計算 `Avg` 為這 6 筆的平均。

### 評分邏輯 (優先權由高至低，符合即停止)

#### 無法評分
- 因網路錯誤或無法連線導致無法獲取資料。

#### 0 分
- 資料不足 (成功連線但來源資料不足 6 個月，農曆年模式為 5 筆)
- 平均數為負數 (`Avg < 0`)
- 或 最新一個月為負數 (`M0 < 0`)

#### 1 分 (優先判定)
- **近期遞減**：過去六個月平均為正 (`Avg > 0`)，但最近三個月呈現遞減走勢 (`M2 > M1 > M0`) (不論幅度)
  - *註：此規則優先於 3 分的高成長但小幅衰退。若連跌三個月，即使平均很高也給 1 分。*

#### 2 分 (負成長判定)
- **曾經負成長**：過去六個月內 (包含 M0..M5 或 M0..M4) 曾經出現任一單月年增率 < 0
  - *註：若 M0 < 0 已在 0 分被攔截，此處主要捕捉歷史月份的負成長。*

#### 4 分
- **高成長且趨勢向上**：
  1. 過去六個月皆為正數 (`All > 0`)
  2. 平均超過 25% (`Avg > 25`)
  3. 最近一個月動能增加或持平 (`M0 >= M1`)

#### 3 分
- **中高度成長且趨勢向上**：
  1. 過去六個月皆為正數 (`All > 0`)
  2. 平均在 10% ~ 25% 之間 (`10 <= Avg <= 25`)
  3. 最近一個月動能增加或持平 (`M0 >= M1`)
- **高成長但短期微回檔**：
  1. 過去六個月皆為正數
  2. 平均超過 25% (`Avg > 25`)
  3. 最近一個月小幅衰退 (`M0 < M1`)，但跌幅在 50% 以內 (`(M1 - M0) / abs(M1) < 0.5`)

#### 2 分 (其他)
- 無法列入其它評等者 (例如平均為正但成長率低，或趨勢不明顯)

---

## 2. 營業利益率 (Operating Profit Margin)

### 變數定義
- **Q0**: 最新一季 (例如 2023 Q1)
- **Q1**: 前一季 (例如 2022 Q4)
- **Q2**: 前二季
- **Q3**: 前三季
- **Avg**: 過去四季平均值 `(Q0 + Q1 + Q2 + Q3) / 4`
- **下跌幅度 (Drop %)**: `(前一季數值 - 當季數值) / abs(前一季數值)`
- **穩定沒有下降**: 指季與季之間的下跌幅度均 < 20% (即 `Drop % < 0.2`)

### 評分邏輯 (優先權由高至低，符合即停止)

#### 無法評分
- 因網路錯誤或無法連線導致無法獲取資料。

#### 0 分
- 過去四季平均數為負數 (`Avg < 0`)
- 或 最新一季為負數 (`Q0 < 0`)
- 或 資料不足四季 (非網路錯誤，而是來源資料不足)

#### 1 分
- 最近一季大跌：最近一季比上一季下跌 20% 以上 (`(Q1 - Q0) / abs(Q1) >= 0.2`)
- 或 獲利能力過低：不論漲跌幅，過去四季平均營益率在 5% 以下 (`Avg < 5`)

#### 4 分
- **穩定且高獲利**：過去四季皆維持穩定沒有下降，且平均在 15% 以上 (`Avg >= 15`)
- **穩定成長中**：過去四季皆維持穩定沒有下降，且平均在 10%~15%，且最近一季呈現上升趨勢 (`Q0 > Q1`)

#### 3 分
- **穩定且獲利尚可**：過去四季皆維持穩定沒有下降，且平均在 10%~15%
- **穩定且轉強中**：過去四季皆維持穩定沒有下降，平均只有 5%~10%，但最近一季呈現上升趨勢 (`Q0 > Q1`)

#### 2 分
- **歷史不穩定**：過去四季曾出現季與季之間下跌 20% 以上 (但不包括最近一季，即 `Q3->Q2` 或 `Q2->Q1` 有大跌)
- **無法列入其它評等者**：例如穩定但獲利普普且無成長 (`5 <= Avg < 10` 且無上升趨勢)

---

## 3. 稅後淨利年增率 (Net Profit YoY Growth Rate)

### 變數定義
- **Data Source**: 最近 4 季的稅後淨利年增率 (YoY %)。
- **Q0**: 最新一季。
- **Q1**: 前一季。
- **Q2**: 前二季。
- **Q3**: 前三季。
- **大幅衰退**: 指本季比上季下跌幅度超過 50% (即 `(Q1 - Q0) / abs(Q1) > 0.5`)。

### 評分邏輯 (優先權由高至低，符合即停止)

#### 無法評分
- 因網路錯誤或無法連線導致無法獲取資料。

#### 0 分
- **連續衰退**：最近兩季皆為負數 (`Q0 < 0` 且 `Q1 < 0`)。
- **資料不足**：成功連線但來源資料不足 4 季。

#### 1 分
- **最近轉弱**：最近一季為負數 (`Q0 < 0`)。
- **體質不佳**：過去四季中出現兩季(含)以上負數。
- **趨勢轉差**：近三季呈現遞減 (`Q2 > Q1 > Q0`) 且最近一季年增率低於 50% (`Q0 < 50`)。

#### 2 分 (優先於高分判定)
- **轉機訊號**：最近一季由負轉正 (`Q1 < 0` 且 `Q0 > 0`)。
- **大幅衰退**：近兩季皆為正數 (`Q0 > 0` 且 `Q1 > 0`)，但最近一季出現 50% 以上的衰退 (`(Q1 - Q0) / Q1 > 0.5`)。

#### 4 分
- **超級成長**：近三季年增率皆在 50% 以上 (`Q0 >= 50` 且 `Q1 >= 50` 且 `Q2 >= 50`) (遞減也無妨，除非跌幅過大先被 2 分攔截)。
- **成長加速**：近三季皆為正數 (`Q0, Q1, Q2 > 0`) 且最近一季呈現成長 (`Q0 > Q1`)。

#### 3 分
- **穩健成長**：近兩季皆為正數 (`Q0 > 0` 且 `Q1 > 0`) 且沒有出現大幅衰退 (跌幅 < 50%)。
  - *註：若符合 4 分條件則優先給 4 分，否則落入此區間。*

---

## 4. 每股盈餘 (EPS)

### 變數定義
- **Sum4Q (TTM)**: 最近四季 EPS 總和。

### 評分邏輯 (優先權由高至低，符合即停止)

#### 無法評分
- 因網路錯誤或無法連線導致無法獲取資料。

#### 0 分
- **累積虧損**：最近四季累積數為負 (`Sum4Q < 0`)。
- **資料不足**：成功連線但來源資料不足 4 季。

#### 1 分
- **最近虧損**：不管累積數，最近一季出現虧損者 (`Q0 < 0`)。
- **累積微利**：最近四季累積總和在 0 到 1 元之間 (`0 <= Sum4Q <= 1`)。

#### 4 分
- **高獲利**：最近四季累積總和超過 5 元 (`Sum4Q > 5`)。

#### 3 分
- **穩健獲利**：最近四季累積總和在 3 到 5 元之間 (`3 < Sum4Q <= 5`)。

#### 2 分
- **普通獲利**：最近四季累積總和在 1 到 3 元之間 (`1 < Sum4Q <= 3`)。

---

## 5. 存貨周轉率 (Inventory Turnover Ratio)

### 變數定義
- **Inv_Q0, Inv_Y0**: 最近一季/一年的存貨。
- **Rev_Q0, Rev_Y0**: 最近一季/一年的營收。
- **Turnover**: 存貨周轉率。
- **Avg**: 四季平均周轉率。
- **Drop**: 下跌幅度。

### 評分邏輯 (優先權由高至低，符合即停止)

#### 無法評分
- 因網路錯誤或無法連線導致無法獲取資料。

#### 不評分
- **低庫存產業**：
  - 最近一季存貨/營收 < 4% (`Inv_Q0 / Rev_Q0 < 0.04`)
  - 或 最近一年存貨/營收 < 1% (`Inv_Y0 / Rev_Y0 < 0.01`)
- **無數據**：成功連線但抓不到存貨相關欄位資料。

#### 0 分
- **資料不足**：成功連線但來源資料不足 4 季。
- **最近崩跌**：最近一季跌幅超過 20% (`Drop(Q1->Q0) > 0.2`)。

#### 1 分
- **曾經崩跌**：過去四季中，曾出現單季跌幅超過 20% (`Drop(Q2->Q1)` 或 `Drop(Q3->Q2) > 0.2`)。

#### 2 分
- **連續緩跌**：最近連續兩季下跌 (`Q2 > Q1 > Q0`) 且累積跌幅超過 20% (`(Q2 - Q0) / Q2 > 0.2`)。

#### 4 分
- **高效能**：穩定無大跌，且 `Avg >= 1.5`。

#### 3 分
- **普通效能**：穩定無大跌，且 `Avg < 1.5`。

---

## 6. 自由現金流量 (Free Cash Flow)

### 變數定義
- **FCF**: `營運現金流 + 投資現金流`。
- **Sum6Q**: 最近六季累積 FCF。
- **Sum4Q**: 最近四季累積 FCF。
- **正負定義**: `> 0` 為正，`<= 0` 為負。

### 評分邏輯 (優先權由高至低，符合即停止)

#### 無法評分
- 因網路錯誤或無法連線導致無法獲取資料。

#### 0 分
- **資料不足**：成功連線但來源資料不足 6 季。
- **持續流出**：六季累積為負 (`Sum6Q <= 0`) 且 四季累積為負 (`Sum4Q <= 0`)。

#### 4 分
- **連續流入**：最近連續六季 FCF 皆為正數 (`Q0..Q5 > 0`)。

#### 3 分
- **累積流入**：六季累積為正 (`Sum6Q > 0`) 且 四季累積為正 (`Sum4Q > 0`)。

#### 2 分
- **近期轉佳**：六季累積為負 (`Sum6Q <= 0`) 但 四季累積為正 (`Sum4Q > 0`)。

#### 1 分
- **近期轉差**：六季累積為正 (`Sum6Q > 0`) 但 四季累積為負 (`Sum4Q <= 0`)。